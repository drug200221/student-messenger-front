<div class="dialog">
  <div [ngClass]="chat.color.toLowerCase()" class="avatar">
    <img alt="" src="">
    {{ chat.title ? this.getLetters(chat.title) : 'ВЫ' }}
  </div>
  <div class="column">
    <div class="row">
      <div class="dialog-title">
        @if (chat.isPrivate) {
          <span [style.font-weight]="400">{{ getPrivateChatRecipientId() }}</span>
        }
        <span>{{ chat.title ?? 'Вы' }}</span>
      </div>
      @if (chat.messages.length > 0) {
        <div class="message-info">
          @if (+chat.messages[chat.messages.length - 1].sender.id === this.userService.$user.value?.id) {
            <span class="message-status">
              @if (chat.messages[chat.messages.length - 1].id <= chat.lastReadMessageId) {
                <mat-icon color="primary">check</mat-icon>
                <mat-icon class="overlapping-icon" color="primary">check</mat-icon>
              } @else {
                <mat-icon>check</mat-icon>
              }
            </span>
          }
          <span class="message-time">{{ getDateMessage(chat.messages[chat.messages.length - 1].date) }}</span>
        </div>
      }
    </div>
    <div class="row">
      @if (chat.messages.length > 0) {
        <div class="subtitle">
          @if (!chat.isPrivate) {
            @if (+chat.messages[chat.messages.length - 1].sender.id !== this.userService.$user.value?.id) {
              <span class="last-user">{{ chat.messages[chat.messages.length - 1].sender.shortName }}: </span>
            }
          }
          @if (+chat.messages[chat.messages.length - 1].sender.id === this.userService.$user.value?.id) {
            <span class="last-user">Вы: </span>
          }
          <span>{{ chat.messages[chat.messages.length - 1].text }}</span>
        </div>
        <div class="badge"
             matBadge="{{  chat.newMessagesCount > 0 ? chat.newMessagesCount : '' }}"></div>
      }
    </div>
  </div>
</div>

